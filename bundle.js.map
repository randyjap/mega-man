{"version":3,"sources":["webpack:///webpack/bootstrap 8fd6e4b17316d5abc110","webpack:///./entry.js","webpack:///./lib/game.js","webpack:///./lib/levels.js","webpack:///./lib/canvas.js","webpack:///./lib/vector_util.js","webpack:///./lib/sprites.js"],"names":["document","addEventListener","restartButton","getElementById","e","preventDefault","canvas","cancelAnimationFrame","window","animation","body","removeChild","proxy","play","arrowCodes","Game","plan","grid","sprites","width","length","height","y","row","transformedRow","x","chr","fieldType","Sprite","characters","push","megaman","filter","player","type","boss","gameStatus","score","prototype","findCollision","pos","size","left","Math","floor","right","ceil","top","bottom","findOverlappingObject","i","other","maxStep","animate","step","keys","thisStep","min","forEach","act","spriteOverlapAction","sprite","hitPoints","hit","round","random","innerHTML","trackKeys","codes","pressed","Object","create","handler","event","hasOwnProperty","keyCode","down","runAnimation","frameFunc","lastTime","frame","time","stop","timeStep","requestAnimationFrame","arrows","start","level","Canvas","gameContinues","display","drawFrame","plans","startLevel","n","console","log","levels","spriteSize","spriteRoll","createElement","src","flipHorizontally","context","around","translate","scale","parent","game","id","innerWidth","appendChild","cx","getContext","animationTime","facingRight","viewport","Date","clear","parentNode","updateViewport","clearDisplay","drawBackground","drawSprites","view","margin","center","plus","times","max","fillStyle","fillRect","xPosition","yPosition","spriteFrameNumber","drawImage","farewellMessage","messageNumber","drawMegaMan","speed","rectangle","Path2D","rect","stroke","save","restore","drawBoss","destroyed","drawHenchman","henchman","drawBullet","VectorUtil","factor","Henchman","Boss","Bullet","Megaman","gravity","jumpSpeed","megamanXSpeed","bossFiringRate","megamanFiringRate","lastFire","moveY","motion","newPos","collidedObject","cFire","fireRight","otherSprite","bulletType","moveX","up","shoot"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8fd6e4b17316d5abc110","import { play } from './lib/game.js';\nimport { levels } from './lib/levels.js';\nimport { Canvas } from './lib/canvas.js';\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  play(levels, Canvas);\n  let restartButton = document.getElementById(\"restart\");\n  restartButton.addEventListener(\"click\", e => {\n    e.preventDefault();\n\n    let canvas = document.getElementById(\"canvas\");\n    if (canvas) {\n      cancelAnimationFrame(window.animation);\n      document.body.removeChild(canvas);\n      play(levels, Canvas);\n    } else {\n      play(levels, Canvas);\n    }\n  });\n\n  let proxy = document.getElementById(\"pause\");\n  proxy.addEventListener(\"click\", e => {\n    e.preventDefault();\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./entry.js","import { VectorUtil } from './vector_util';\nimport { Boss, Bullet, Megaman, Henchman } from './sprites';\n\nlet arrowCodes = { 65: \"left\", 87: \"up\", 68: \"right\", 32: \"shoot\" };\n\nfunction Game(plan) {\n  this.grid = [];\n  this.sprites = [];\n  this.width = plan[0].length;\n  this.height = plan.length;\n\n  for (let y = 0; y < this.height; y++) {\n    let row = plan[y], transformedRow = [];\n    for (let x = 0; x < this.width; x++) {\n      let chr = row[x];\n      let fieldType = null;\n      let Sprite = characters[chr];\n      if (Sprite)\n        this.sprites.push(new Sprite(new VectorUtil(x, y), chr));\n      else if (chr === \"#\")\n        fieldType = \"block\";\n      else if (chr === \"W\")\n        fieldType = \"water\";\n      transformedRow.push(fieldType);\n    }\n    this.grid.push(transformedRow);\n  }\n\n  this.megaman = this.sprites.filter(player => {\n    return player.type === \"megaman\";\n  })[0];\n\n  this.boss = this.sprites.filter(player => {\n    return player.type === \"boss\";\n  })[0];\n\n  this.gameStatus = null;\n  this.score = 0;\n}\n\nlet characters = {\n  \"M\": Megaman,\n  \"B\": Boss,\n  \"H\": Henchman\n};\n\nGame.prototype.findCollision = function(pos, size) {\n  let left = Math.floor(pos.x);\n  let right = Math.ceil(pos.x + size.x);\n  let top = Math.floor(pos.y);\n  let bottom = Math.ceil(pos.y + size.y);\n\n  if (left < 0 || right > this.width || top < 0) return \"block\";\n\n  for (let y = top; y < bottom; y++) {\n    for (let x = left; x < right; x++) {\n      let fieldType = this.grid[y][x];\n      if (fieldType) return fieldType;\n    }\n  }\n};\n\nGame.prototype.findOverlappingObject = function(player) {\n  for (let i = 0; i < this.sprites.length; i++) {\n    let other = this.sprites[i];\n    if (other !== player &&\n        player.pos.x + player.size.x > other.pos.x &&\n        player.pos.x < other.pos.x + other.size.x &&\n        player.pos.y + player.size.y > other.pos.y &&\n        player.pos.y < other.pos.y + other.size.y)\n      return other;\n  }\n};\n\nlet maxStep = 0.05;\n\nGame.prototype.animate = function(step, keys) {\n  while (step > 0) {\n    let thisStep = Math.min(step, maxStep);\n    this.sprites.forEach(function(player) {\n      player.act(thisStep, this, keys);\n    }, this);\n    step -= thisStep;\n  }\n};\n\nGame.prototype.spriteOverlapAction = function(type, player, sprite) {\n  if (type === \"water\" && this.gameStatus === null) {\n    if (this.megaman.hitPoints > 0) this.megaman.hitPoints -= 0.3;\n    if (this.megaman.hitPoints <= 0) {\n      this.gameStatus = \"lost\";\n    }\n    this.megaman.hit = true;\n  } else if (type === \"friendly-bullet\" && sprite && sprite.type === \"boss\" && this.gameStatus === null) {\n    sprite.hitPoints--;\n    this.score += Math.round(100000 * Math.random());\n    document.getElementById(\"score\").innerHTML = `Score: ${this.score}`;\n    sprite.hit = true;\n    if (sprite.hitPoints <= 0) {\n      this.gameStatus = \"won\";\n    }\n  } else if (type === \"friendly-bullet\" && sprite && sprite.type === \"henchman\" && this.gameStatus === null) {\n    if (sprite.hitPoints > 0) sprite.hitPoints--;\n    this.score += Math.round(100000 * Math.random());\n    document.getElementById(\"score\").innerHTML = `Score: ${this.score}`;\n    sprite.hit = true;\n  } else if (type === \"unfriendly-bullet\" && sprite && sprite.type === \"megaman\" && this.gameStatus === null) {\n    sprite.hitPoints--;\n    sprite.hit = true;\n    if (sprite.hitPoints <= 0) {\n      this.gameStatus = \"lost\";\n    }\n  }\n};\n\nfunction trackKeys(codes) {\n  let pressed = Object.create(null);\n  function handler(event) {\n    if (codes.hasOwnProperty(event.keyCode)) {\n      let down = event.type === \"keydown\";\n      pressed[codes[event.keyCode]] = down;\n      event.preventDefault();\n    }\n  }\n  addEventListener(\"keydown\", handler);\n  addEventListener(\"keyup\", handler);\n  return pressed;\n}\n\nfunction runAnimation(frameFunc) {\n  let lastTime = null;\n  function frame(time) {\n    let stop = false;\n    if (lastTime !== null) {\n      let timeStep = Math.min(time - lastTime, 100) / 1000;\n      stop = frameFunc(timeStep) === false;\n    }\n    lastTime = time;\n    if (!stop)\n      window.animation = requestAnimationFrame(frame);\n  }\n  requestAnimationFrame(frame);\n}\n\nlet arrows = trackKeys(arrowCodes);\n\nfunction start(level, Canvas, gameContinues) {\n  let display = new Canvas(document.body, level);\n  window.display = display;\n  runAnimation(function(step) {\n    level.animate(step, arrows);\n    display.drawFrame(step);\n  });\n}\n\nexport function play(plans, Canvas) {\n  function startLevel(n) {\n    start(new Game(plans[n]), Canvas, function(gameStatus) {\n      if (gameStatus === \"lost\")\n        console.log(gameStatus);\n      else if (gameStatus === \"won\")\n        console.log(gameStatus);\n    });\n  }\n  startLevel(0);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/game.js","export let levels = [\n  [\"                                                                                \",\n   \"                                                                                \",\n   \"                                                                                \",\n   \"                                                                           B    \",\n   \"                                                     H     #####################\",\n   \"                                                   #####                        \",\n   \"                                       H    ####                                \",\n   \"                                 H   ####                                       \",\n   \"                         H    #####          ####      ####     ####   ####     \",\n   \"                   H   ####           ####                                      \",\n   \"     M           ####                             ####                          \",\n   \"WW############WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\",\n   \"                                                                                \",]\n ];\n\n\n\n// WEBPACK FOOTER //\n// ./lib/levels.js","let spriteSize = 50;\nlet spriteRoll = document.createElement(\"img\");\nspriteRoll.src = \"images/megaman.png\";\n\nfunction flipHorizontally(context, around) {\n  context.translate(around, 0);\n  context.scale(-1, 1);\n  context.translate(-around, 0);\n}\n\nexport function Canvas(parent, game) {\n  this.canvas = document.createElement(\"canvas\");\n  this.canvas.id = \"canvas\";\n  this.canvas.width = Math.min(window.innerWidth, game.width * spriteSize);\n  this.canvas.height = Math.min(window.innerWidth / 3, game.height * spriteSize);\n  parent.appendChild(this.canvas);\n  this.cx = this.canvas.getContext(\"2d\");\n\n  this.game = game;\n  this.animationTime = 0;\n  this.facingRight = false;\n\n  this.viewport = {\n    left: 0,\n    top: 0,\n    width: this.canvas.width / spriteSize,\n    height: this.canvas.height / spriteSize\n  };\n\n  this.start = new Date();\n  this.drawFrame(0);\n}\n\nCanvas.prototype.clear = function() {\n  this.canvas.parentNode.removeChild(this.canvas);\n};\n\nCanvas.prototype.drawFrame = function(step) {\n  this.animationTime += step;\n\n  this.updateViewport();\n  this.clearDisplay();\n  this.drawBackground();\n  this.drawSprites();\n};\n\nCanvas.prototype.updateViewport = function() {\n  let view = this.viewport, margin = view.width / 6;\n  let megaman = this.game.megaman;\n  let center = megaman.pos.plus(megaman.size.times(0.5));\n\n  if (center.x < view.left + margin * 2) {\n    view.left = Math.max(center.x - margin * 2, 0);\n  }  else if (center.x > view.left + view.width - margin * 2) {\n    view.left = Math.min(center.x + margin * 2 - view.width, this.game.width - view.width);\n  }\n\n  if (center.y < view.top + margin) {\n    view.top = Math.max(center.y - margin, 0);\n  }  else if (center.y > view.top + view.height - margin) {\n    view.top = Math.min(center.y + margin - view.height, this.game.height - view.height);\n  }\n};\n\nCanvas.prototype.clearDisplay = function() {\n  if (this.game.gameStatus === \"won\") {\n    //TODO\n    console.log(\"YOU WON!\");\n  } else if (this.game.gameStatus === \"lost\") {\n    //TODO\n    console.log(\"YOU LOST!\");\n  } else {\n    this.cx.fillStyle = \"lightblue\";\n  }\n  // Don't forget to make things transparent!\n  this.cx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n};\n\nCanvas.prototype.drawBackground = function() {\n  let view = this.viewport;\n  let left = Math.floor(view.left);\n  let right = Math.ceil(view.left + view.width);\n  let top = Math.floor(view.top);\n  let bottom = Math.ceil(view.top + view.height);\n\n  for (let y = top; y < bottom; y++) {\n    for (let x = left; x < right; x++) {\n      let fieldType = this.game.grid[y][x];\n      if (fieldType === null) continue;\n      let xPosition = (x - view.left) * spriteSize;\n      let yPosition = (y - view.top) * spriteSize;\n\n      let spriteFrameNumber;\n      if (fieldType === \"water\") spriteFrameNumber = 16;\n      if (fieldType === \"block\") spriteFrameNumber = 15;\n\n      this.cx.drawImage(\n        spriteRoll,\n        (spriteFrameNumber * spriteSize), 0, spriteSize, spriteSize,\n        xPosition, yPosition, spriteSize, spriteSize\n      );\n    }\n  }\n\n  let farewellMessage = document.createElement(\"img\");\n  farewellMessage.src = \"images/win-loss.png\";\n  let messageNumber;\n\n  if (this.game.gameStatus === \"lost\") {\n    messageNumber = 1;\n    this.cx.drawImage(\n      farewellMessage,\n      (messageNumber * 400), 0,\n      400, 200,\n      400 + (right - left) / 2, 100 + (bottom - top) / 2,\n      400, 200\n    );\n  } else if (this.game.gameStatus === \"won\") {\n    messageNumber = 0;\n    this.cx.drawImage(\n      farewellMessage,\n      (messageNumber * 400), 0,\n      400, 200,\n      400 + (right - left) / 2, 100 + (bottom - top) / 2,\n      400, 200\n    );\n  } else if (new Date() - this.start < 7000) {\n    messageNumber = 2;\n    this.cx.drawImage(\n      farewellMessage,\n      (messageNumber * 400), 0,\n      400, 200,\n      400 + (right - left) / 2, 100 + (bottom - top) / 2,\n      400, 200\n    );\n  }\n};\n\nCanvas.prototype.drawMegaMan = function(x, y, width, height) {\n  let spriteFrameNumber = 0;\n  let megaman = this.game.megaman;\n\n  if (megaman.hitPoints > 0 && megaman.hitPoints < 50) megaman.hitPoints += 0.02;\n\n  document.getElementById(\"megaman-health\").innerHTML = `Megaman Health: ${Math.round(megaman.hitPoints)}`;\n\n  if (megaman.speed.x !== 0) this.facingRight = megaman.speed.x < 0;\n\n  if (megaman.hit) {\n    spriteFrameNumber = 14;\n  } else if (megaman.speed.y !== 0) {\n    spriteFrameNumber = 11;\n  } else if (megaman.speed.x !== 0) {\n    spriteFrameNumber = Math.floor(this.animationTime * 12) % 10 + 1;\n  }\n\n  let rectangle = new Path2D();\n  rectangle.rect(x, y - 20, 50 * megaman.hitPoints / 50, 20);\n  this.cx.stroke(rectangle);\n  this.cx.save(); //keep drawing context intact\n\n  if (this.facingRight) flipHorizontally(this.cx, x + width / 2);\n  this.cx.drawImage(\n    spriteRoll,\n    (spriteFrameNumber * width), 0,\n    width, height,\n    x, y, width, height\n  );\n\n  this.cx.restore(); //restore drawing context\n\n};\n\nCanvas.prototype.drawBoss = function(x, y, width, height) {\n  let spriteFrameNumber = 13;\n  let boss = this.game.boss;\n  if (boss.destroyed) {\n    spriteFrameNumber = [17, 18][Math.floor(Math.random() * [17, 18].length)];\n  } else if (boss.hit) {\n    spriteFrameNumber = [17, 18][Math.floor(Math.random() * [17, 18].length)];\n  }\n\n  if (!boss.destroyed && boss.hitPoints < 100) boss.hitPoints += 0.02;\n  document.getElementById(\"boss-health\").innerHTML = `Boss Health: ${Math.round(boss.hitPoints)}`;\n\n  if (!boss.destroyed) {\n    let rectangle = new Path2D();\n    rectangle.rect(x, y - 20, 50 * boss.hitPoints / 50, 20);\n    this.cx.stroke(rectangle);\n  }\n\n  this.cx.save(); //keep drawing context intact\n  if (this.game.megaman.pos.x > this.game.boss.pos.x) flipHorizontally(this.cx, x + width / 2);\n\n  this.cx.drawImage(\n    spriteRoll,\n    (spriteFrameNumber * width), 0,\n    width, height,\n    x, y, width, height\n  );\n\n  this.cx.restore(); //restore drawing context\n};\n\nCanvas.prototype.drawHenchman = function(x, y, width, height, henchman) {\n  if (!henchman.destroyed) {\n    let spriteFrameNumber = 20;\n    if (henchman.hitPoints <= 0) henchman.destroyed = true;\n    if (henchman.hit) {\n      spriteFrameNumber = [17, 20][Math.floor(Math.random() * [17, 20].length)];\n    }\n\n    let rectangle = new Path2D();\n    rectangle.rect(x, y - 20, 45 * henchman.hitPoints / 20, 20);\n    this.cx.stroke(rectangle);\n\n    this.cx.save(); //keep drawing context intact\n    if (this.game.megaman.pos.x > henchman.pos.x) flipHorizontally(this.cx, x + width / 2);\n\n\n    this.cx.drawImage(\n      spriteRoll,\n      (spriteFrameNumber * width), 0,\n      width, height,\n      x, y, width, height\n    );\n\n    this.cx.restore(); //restore drawing context\n  }\n};\n\nCanvas.prototype.drawBullet = function(x, y, width, height) {\n  let spriteFrameNumber = 12;\n  this.cx.drawImage(\n    spriteRoll,\n    (spriteFrameNumber * width), 0,\n    width, height,\n    x, y, width, height\n  );\n};\n\nCanvas.prototype.drawSprites = function() {\n  this.game.sprites.forEach(function(sprite) {\n    let width = sprite.size.x * spriteSize;\n    let height = sprite.size.y * spriteSize;\n    let x = (sprite.pos.x - this.viewport.left) * spriteSize;\n    let y = (sprite.pos.y - this.viewport.top) * spriteSize;\n    if (sprite.type === \"megaman\") {\n      this.drawMegaMan(x, y, width, height);\n    } else if (sprite.type === \"boss\"){\n      this.drawBoss(x, y, width, height);\n    } else if (sprite.type === \"henchman\"){\n      this.drawHenchman(x, y, width, height, sprite);\n    } else if (sprite.type === \"friendly-bullet\"){\n      this.drawBullet(x, y, width, height);\n    } else if (sprite.type === \"unfriendly-bullet\"){\n      this.drawBullet(x, y, width, height);\n    }\n  }, this);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/canvas.js","export function VectorUtil(x, y) {\n  this.x = x; this.y = y;\n}\nVectorUtil.prototype.plus = function(other) {\n  return new VectorUtil(this.x + other.x, this.y + other.y);\n};\nVectorUtil.prototype.times = function(factor) {\n  return new VectorUtil(this.x * factor, this.y * factor);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/vector_util.js","import { VectorUtil } from './vector_util';\n\nlet gravity = 45;\nlet jumpSpeed = 18;\nlet megamanXSpeed = 6;\nlet bossFiringRate =  4 / 3;\nlet megamanFiringRate = 1 / 3;\n\nexport function Henchman(pos) {\n  this.pos = pos.plus(new VectorUtil(0, 0));\n  this.size = new VectorUtil(1, 1);\n  this.speed = new VectorUtil(0, 0);\n  this.hitPoints = 20;\n  this.lastFire = new Date();\n  this.hit = false;\n  this.destroyed = false;\n}\n\nHenchman.prototype.type = \"henchman\";\n\nHenchman.prototype.moveY = function(step, game) {\n  this.speed.y += step * gravity;\n  let motion = new VectorUtil(0, this.speed.y * step);\n  let newPos = this.pos.plus(motion);\n  let collidedObject = game.findCollision(newPos, this.size);\n  if (collidedObject) {\n    game.spriteOverlapAction(collidedObject);\n    if (this.hitPoints > 0 && this.speed.y > 0) {\n      this.speed.y = 0;\n      this.speed.y = -(Math.random() * (20 - 5) + 5);\n    } else {\n      this.speed.y = 0;\n    }\n  } else {\n    this.pos = newPos;\n  }\n};\n\nHenchman.prototype.act = function(step, game) {\n  this.moveY(step, game);\n\n  // this will slow down the firing rate to 3 a second\n  if (!this.destroyed) {\n    let cFire = new Date();\n    if (((cFire - this.lastFire) / 1000) > bossFiringRate){\n      let fireRight = true;\n      if (this.pos.x > game.megaman.pos.x) fireRight = false;\n      game.sprites.push(new Bullet(new VectorUtil(this.pos.x, this.pos.y), \"unfriendly-bullet\", fireRight));\n      this.lastFire = cFire;\n    }\n  }\n\n  let otherSprite = game.findOverlappingObject(this);\n  if (otherSprite) {\n    game.spriteOverlapAction(otherSprite.type, otherSprite, this);\n  } else {\n    this.hit = false;\n  }\n};\n\nexport function Boss(pos) {\n  this.pos = pos.plus(new VectorUtil(0, 0));\n  this.size = new VectorUtil(1, 1);\n  this.speed = new VectorUtil(0, 0);\n  this.hitPoints = 100;\n  this.lastFire = new Date();\n  this.hit = false;\n  this.destroyed = false;\n}\n\nBoss.prototype.type = \"boss\";\n\nBoss.prototype.moveY = function(step, game) {\n  this.speed.y += step * gravity;\n  let motion = new VectorUtil(0, this.speed.y * step);\n  let newPos = this.pos.plus(motion);\n  let collidedObject = game.findCollision(newPos, this.size);\n  if (collidedObject) {\n    game.spriteOverlapAction(collidedObject);\n    if (this.hitPoints > 0 && this.speed.y > 0) {\n      this.speed.y = 0;\n      this.speed.y = -(Math.random() * (20 - 5) + 5);\n    } else {\n      this.speed.y = 0;\n    }\n  } else {\n    this.pos = newPos;\n  }\n};\n\nBoss.prototype.act = function(step, game) {\n  this.moveY(step, game);\n\n  // this will slow down the firing rate to 3 a second\n  if (!this.destroyed) {\n    let cFire = new Date();\n    if (((cFire - this.lastFire) / 1000) > bossFiringRate){\n      let fireRight = true;\n      if (this.pos.x > game.megaman.pos.x) fireRight = false;\n      game.sprites.push(new Bullet(new VectorUtil(this.pos.x, this.pos.y), \"unfriendly-bullet\", fireRight));\n      this.lastFire = cFire;\n    }\n  }\n\n  let otherSprite = game.findOverlappingObject(this);\n  if (otherSprite) {\n    game.spriteOverlapAction(otherSprite.type, otherSprite, this);\n  } else {\n    this.hit = false;\n  }\n\n  if (game.gameStatus === \"won\") {\n    this.destroyed = true;\n  }\n};\n\nexport function Bullet(pos, bulletType, fireRight) {\n  this.pos = pos.plus(new VectorUtil(0, 0));\n  this.size = new VectorUtil(1, 1);\n  if (fireRight === true) {\n    this.speed = new VectorUtil(10, 0);\n  } else if (fireRight === false) {\n    this.speed = new VectorUtil(-10, 0);\n  } else if (window.display.facingRight) {\n    this.speed = new VectorUtil(-10, 0);\n  } else {\n    this.speed = new VectorUtil(10, 0);\n  }\n  this.type = bulletType;\n}\n\nBullet.prototype.moveX = function(step, game, keys) {\n  let motion = new VectorUtil(this.speed.x * step, 0);\n  let newPos = this.pos.plus(motion);\n  this.pos = newPos;\n};\n\nBullet.prototype.act = function(step, game) {\n  this.moveX(step, game);\n};\n\nexport function Megaman(pos) {\n  this.pos = pos.plus(new VectorUtil(0, 0));\n  this.size = new VectorUtil(1, 1);\n  this.speed = new VectorUtil(0, 0);\n  this.lastFire = new Date();\n  this.hitPoints = 50;\n  this.hit = false;\n}\n\nMegaman.prototype.type = \"megaman\";\n\nMegaman.prototype.moveX = function(step, game, keys) {\n  this.speed.x = 0;\n  if (keys.left) this.speed.x -= megamanXSpeed;\n  if (keys.right) this.speed.x += megamanXSpeed;\n\n  let motion = new VectorUtil(this.speed.x * step, 0);\n  let newPos = this.pos.plus(motion);\n  let collidedObject = game.findCollision(newPos, this.size);\n  if (collidedObject) {\n    game.spriteOverlapAction(collidedObject);\n  } else if (this.hitPoints > 0) {\n    this.hit = false;\n    this.pos = newPos;\n  }\n};\n\nMegaman.prototype.moveY = function(step, game, keys) {\n  this.speed.y += step * gravity;\n  let motion = new VectorUtil(0, this.speed.y * step);\n  let newPos = this.pos.plus(motion);\n  let collidedObject = game.findCollision(newPos, this.size);\n  if (collidedObject) {\n    game.spriteOverlapAction(collidedObject);\n    if (keys.up && this.speed.y > 0) {\n      this.speed.y = -jumpSpeed;\n    } else {\n      this.speed.y = 0;\n    }\n  } else if (this.hitPoints > 0) {\n    this.pos = newPos;\n  }\n};\n\nMegaman.prototype.act = function(step, game, keys) {\n  this.moveX(step, game, keys);\n  this.moveY(step, game, keys);\n  if (keys.shoot && this.hitPoints > 0) {\n    // this will slow down the firing rate to 3 a second\n    let cFire = new Date();\n    if (((cFire - this.lastFire) / 1000) > megamanFiringRate){\n      game.sprites.push(new Bullet(new VectorUtil(this.pos.x, this.pos.y), \"friendly-bullet\"));\n      this.lastFire = cFire;\n    }\n  }\n\n  let otherSprite = game.findOverlappingObject(this);\n  if (otherSprite) {\n    game.spriteOverlapAction(otherSprite.type, otherSprite, this);\n  }\n\n  // Losing animation\n  if (game.gameStatus === \"lost\") {\n    this.hit = true;\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/sprites.js"],"sourceRoot":""}